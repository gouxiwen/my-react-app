{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","utils/event.js","pages/Demo/Demo.js"],"names":["_arrayLikeToArray","arr","len","length","i","arr2","Array","_slicedToArray","isArray","Symbol","iterator","Object","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","err","o","minLen","n","prototype","toString","call","slice","constructor","name","from","test","TypeError","this","events","create","fn","args","fns","forEach","index","indexOf","splice","only","apply","arguments","off","on","useFriendStatus","friendID","useState","isOnline","setIsOnline","useEffect","handleStatusChange","status","myEvent","FriendStatus","props","friend","id","style","color","FriendListItem","Demo","className","map","item","key","onClick","emit","changeStatus"],"mappings":"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","file":"static/js/5.85a326e7.chunk.js","sourcesContent":["export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(n);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","class Event {\n    constructor() {\n        // 创建一个事件对象\n          this.events = Object.create(null);\n        // events: {\n\t\t//\thehe: [(func)fn1,(func)fn2,...],\n\t\t//\thaha: [(func)fn1,(func)fn2,...],\n\t\t//\t....\n\t\t//\t....\n\t\t//\t}  \n      }\n      // 绑定事件\n      on(name, fn) {\n        // 没有该事件? 初始化处理函数数组为空\n        if (!this.events[name]) {\n            this.events[name] = []\n          }\n          // 否则push一个事件,\n          this.events[name].push(fn);\n          // return 自身方便链式调用\n          return this;\n      }\n      // 通知事件\n      emit(name, ...args) {\n      //没有该事件?不执行\n        if (!this.events[name]) {\n            return this;\n        }\n        const fns = this.events[name]\n        //执行该事件对应的函数数组, 并传入参数\n        fns.forEach(fn => fn.call(this, ...args))\n        return this;\n      }\n      // 解绑事件\n      off(name,fn) {\n        if (!this.events[name]) {\n            return this;\n        }\n        // 没有指定解绑事件? 解绑所有\n        if (!fn) {\n           this.events[name] = null\n           return this\n        }\n        // 否则找到该事件,解绑\n        const index = this.events[name].indexOf(fn);\n        this.events[name].splice(index, 1);\n        return this;\n      }\n      // 单次绑定事件,执行完后解绑\n      once(name,fn) {\n        const only = () => {\n          fn.apply(this, arguments);\n          this.off(name, only);\n        };\n        this.on(name, only);\n        return this;\n      }\n  }\n\nexport default new Event()","import React, {useEffect, useState} from 'react';\nimport myEvent from '../../utils/event';\nimport './Demo.scss'\n// Hooks\n// const Demo = () => {\n//     const [count, SetCount] = useState(0);\n//     const [name] = useState('');\n//     useEffect(() => {\n//         document.title = `${count}次`\n//         console.log('本次组件更新')\n//         return () => {\n//             console.log('上一次清除或者卸载')\n//         };\n//     }, [count]);\n//     useEffect(() => {\n//         document.title = `${name}次`\n//         console.log('组件更新')\n//         return () => {\n//             console.log('组件卸载')\n//         };\n//     }, [name]);\n//     return (\n//         <div>\n//             <p>你点击了{count}次</p>\n//             <button\n//             onClick={() => {SetCount(count + 1)}}>点击</button>\n//         </div>\n//     );\n// }\n// 自定义Hooks\n// eg:提取好友在线状态\nfunction useFriendStatus(friendID) {\n    const [isOnline, setIsOnline] = useState(null)\n    useEffect(() => {\n        function handleStatusChange(status) {\n            setIsOnline(status.isOnline)\n        }\n        // ChatAPI.subscribeToFriendStatus(friendID, handleStatusChange); // 添加监听\n        myEvent.on(friendID, handleStatusChange); // 添加监听\n        return () => {\n            // ChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange); // 移除监听\n            myEvent.off(friendID, handleStatusChange); // 移除监听\n        };\n    });\n    return isOnline;\n}\n// 在下面组件中运用\nfunction FriendStatus(props) {\n    const isOnline = useFriendStatus(props.friend.id);\n    return (\n        <li style={{color: isOnline ? 'green' : 'black'}}>\n            {props.friend.name}\n        </li>\n    )\n}\nfunction FriendListItem(props) {\n    const isOnline = useFriendStatus(props.friend.id);\n    if (isOnline === null) {\n        return 'Loading...'\n    }\n    return isOnline ? 'Online' : 'Offline'\n}\nconst Demo = () => {\n    const friends = [\n        {\n            id: '1',\n            name: '张三',\n            isOnline: false\n        },\n        {\n            id: '2',\n            name: '李四',\n            isOnline: false\n        },\n    ]\n    function changeStatus(item) {\n        item.isOnline = !item.isOnline\n        myEvent.emit(item.id, {isOnline: item.isOnline})\n    }\n    return (\n        <div className=\"demo-wrap\">\n             {\n                 friends.map(item => {\n                    return (\n                        <div key={item.id} className=\"friend-item\">\n                            <div className=\"status\">\n                                <FriendStatus friend={item}></FriendStatus>\n                                <FriendListItem friend={item}></FriendListItem>\n                            </div>\n                            <button className=\"button\" onClick={() => { changeStatus(item)}}>改变在线状态</button>\n                        </div>\n\n                    )\n                 })\n             }\n        </div>\n    )\n}\nexport default Demo;\n"],"sourceRoot":""}